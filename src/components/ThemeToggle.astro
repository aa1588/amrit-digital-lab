---
---

<button id="theme-toggle" aria-label="Toggle theme">
  <!-- Sun: shown in light mode -->
  <span class="icon sun-icon">
    <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round">
      <circle cx="12" cy="12" r="4"/>
      <line x1="12" y1="2"   x2="12" y2="5"/>
      <line x1="12" y1="19"  x2="12" y2="22"/>
      <line x1="2"  y1="12"  x2="5"  y2="12"/>
      <line x1="19" y1="12"  x2="22" y2="12"/>
      <line x1="4.93" y1="4.93"   x2="6.93" y2="6.93"/>
      <line x1="17.07" y1="17.07" x2="19.07" y2="19.07"/>
      <line x1="4.93"  y1="19.07" x2="6.93"  y2="17.07"/>
      <line x1="17.07" y1="6.93"  x2="19.07" y2="4.93"/>
    </svg>
  </span>

  <!-- Moon + stars: shown in dark mode -->
  <span class="icon moon-icon">
    <svg width="19" height="19" viewBox="0 0 24 24">
      <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z" fill="currentColor"/>
      <circle cx="19.5" cy="3.5" r="0.9" fill="currentColor"/>
      <circle cx="22.2" cy="7.5" r="0.6" fill="currentColor"/>
      <circle cx="17.2" cy="1.5" r="0.55" fill="currentColor"/>
    </svg>
  </span>
</button>

<style>
  #theme-toggle {
    background: var(--color-bg-secondary);
    border: 1px solid var(--color-border);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 34px;
    height: 34px;
    border-radius: 8px;
    color: var(--color-text-secondary);
    position: relative;
    transition: border-color 0.2s, color 0.2s;
    overflow: hidden;
  }

  #theme-toggle:hover {
    color: var(--color-text);
    border-color: var(--color-text-secondary);
  }

  /* Sun spins slowly on hover */
  #theme-toggle:hover .sun-icon svg {
    transform: rotate(45deg);
  }

  .icon {
    position: absolute;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: opacity 0.3s ease, transform 0.4s ease;
  }

  .sun-icon svg {
    transition: transform 0.5s ease;
  }

  /* Light mode */
  [data-theme="light"] .sun-icon {
    opacity: 1;
    transform: rotate(0deg) scale(1);
  }
  [data-theme="light"] .moon-icon {
    opacity: 0;
    transform: translateY(8px) scale(0.75);
    pointer-events: none;
  }

  /* Dark mode */
  [data-theme="dark"] .moon-icon {
    opacity: 1;
    transform: translateY(0px) scale(1);
  }
  [data-theme="dark"] .sun-icon {
    opacity: 0;
    transform: translateY(-8px) scale(0.75);
    pointer-events: none;
  }
</style>

<script>
  const theme = (() => {
    if (typeof localStorage !== 'undefined' && localStorage.getItem('theme')) {
      return localStorage.getItem('theme');
    }
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      return 'dark';
    }
    return 'light';
  })();

  if (theme === 'light') {
    document.documentElement.setAttribute('data-theme', 'light');
  } else {
    document.documentElement.setAttribute('data-theme', 'dark');
  }

  window.localStorage.setItem('theme', theme);

  const handleToggleClick = () => {
    const element = document.documentElement;
    const currentTheme = element.getAttribute('data-theme');
    const newTheme = currentTheme === 'light' ? 'dark' : 'light';
    element.setAttribute('data-theme', newTheme);
    localStorage.setItem('theme', newTheme);
  };

  document.getElementById('theme-toggle')?.addEventListener('click', handleToggleClick);
</script>
